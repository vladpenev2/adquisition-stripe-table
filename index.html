<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pricing</title>

  <script async src="https://js.stripe.com/v3/pricing-table.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: transparent;
    }
    body {
      display: flex;
      justify-content: center;
    }
    stripe-pricing-table {
      width: 100%;
      max-width: 980px;
    }
  </style>
</head>

<body>
  <stripe-pricing-table
    id="pricingTable"
    pricing-table-id="prctbl_1SdrR4LDt44NDJA3mdDTEFkR"
    publishable-key="pk_live_51SdqIILDt44NDJA3n6Uz5TYybeSDaBDTh8OWVJHyLY9auQ6zk1AYJxMR7MHUz5zJ2PpzVB2r470VDTc0QQPcqqXm00lO95lz7u">
  </stripe-pricing-table>

  <script>
    const params = new URLSearchParams(window.location.search);
    const email = params.get("email");
    const clientSecret = params.get("customer_session");

    const table = document.getElementById("pricingTable");

    customElements.whenDefined("stripe-pricing-table").then(() => {
      if (clientSecret) {
        // Existing customer (upgrade/downgrade)
        table.setAttribute(
          "customer-session-client-secret",
          clientSecret
        );
      } else if (email) {
        // Free trial / new user
        table.setAttribute("customer-email", decodeURIComponent(email));
      }
    });
  </script>
</body>
</html>
